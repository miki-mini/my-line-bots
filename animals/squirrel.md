# 🐿️ リスのほっぺたどんぐりゲーム

MediaPipe Handsを使用した、2人対戦型の手を使ったインタラクティブゲームです。
画面上から落ちてくるどんぐりやくるみを手でキャッチして、リスのほっぺたをパンパンに膨らませた方が勝ちです！

<img src="mages/squirrel.png" width="300">

## 🎮 機能

- **手認識**: MediaPipe Hands APIを使用したリアルタイム手検出
- **2人対戦**: 画面左側がPlayer 1、右側がPlayer 2の分割プレイ
- **表情変化**: スコアに応じてリスのほっぺたが段階的に膨らむ
- **複数のアイテム**:
  - 🌰 **どんぐり**: +10点
  - 🥔 **くるみ**: +30点
  - ⚠️ **イガ栗**: -50点（ダメージ）
- **難易度選択**: ふつう と むずかしい の2モード
- **Fever Time**: 残り10秒でアイテムが大量に降り注ぐ
- **効果音**: Web Audio APIによる合成音
- **BGM**: ゲームを盛り上げるBGM付き

## 🚀 デモ

| ゲーム中 | 結果画面 |
|:---:|:---:|
| <img src="https://storage.googleapis.com/zenn-user-upload/d61312e69e40-20260106.png" width="300"> | <img src="https://storage.googleapis.com/zenn-user-upload/b8015cbee24a-20260106.png" width="300"> |

## 📋 動作環境

- モダンブラウザ（Chrome、Edge、Safari推奨）
- Webカメラ
- HTTPS または localhost（カメラアクセスに必要）

## 🛠️ セットアップ

1. リポジトリをクローン:
```bash
git clone https://github.com/yourusername/squirrel-cheeks-game.git
cd squirrel-cheeks-game
```

2. アセットを配置:
```
static/
└── images/
    └── squirrel/
        ├── squirrel_neutral.png
        ├── squirrel_cheek_1.png
        ├── squirrel_cheek_2.png
        ├── squirrel_win.png
        ├── squirrel_pain.png
        ├── item_acorn.png
        ├── item_walnut.png
        ├── item_chestnut.png
        ├── tree.png
        └── bgm.mp3
```

3. ローカルサーバーで起動:
```bash
# Python 3を使用
python -m http.server 8000

# Node.jsを使用
npx serve

# PHPを使用
php -S localhost:8000
```

4. ブラウザで `http://localhost:8000` を開く

## 🎯 遊び方

1. カメラの前に2人で立つ
   - 左側 → Player 1
   - 右側 → Player 2
2. 難易度を選択（ふつう または むずかしい）
3. 落ちてくるアイテムを手でキャッチ:
   - 人差し指をアイテムに触れさせる
   - いいアイテムはスコアUP＆ほっぺた膨張
   - イガ栗は避ける（減点！）
4. 60秒後に高得点のプレイヤーが勝利
5. 残り10秒で **Fever Time** 発動！

## 🏗️ 技術スタック

- **MediaPipe Hands**: 手のトラッキングとランドマーク検出
- **HTML5 Canvas**: ゲーム描画と当たり判定
- **Web Audio API**: リアルタイム音声合成
- **CSS3 Animations**: リスのアニメーションとエフェクト
- **Vanilla JavaScript**: フレームワーク不使用のピュアJS

## 📁 プロジェクト構成

```
.
├── index.html              # メインのゲームファイル
├── static/
│   └── images/
│       └── squirrel/       # ゲームアセット
├── docs/
│   └── screenshot.png      # ドキュメント用画像
└── README.md
```

## 🧩 実装の詳細

### 手の検出
- 最大4本の手を同時検出（2人 × 両手）
- 人差し指の先端（ランドマーク#8）を当たり判定に使用
- ミラーモードで自然な操作感を実現

### 座標系
```javascript
// CSS transform: scaleX(-1) による反転
// カメラ左側 (x < 0.5) → 画面右側 (Player 2)
// カメラ右側 (x > 0.5) → 画面左側 (Player 1)
const isP1 = handX > 0.5;
```

### 当たり判定
```javascript
const distance = Math.sqrt(
    Math.pow(item.x - hand.x, 2) +
    Math.pow(item.y - hand.y, 2)
);
if (distance < 0.08) {
    // アイテムをキャッチ！
}
```

## 🎨 カスタマイズ

### 難易度調整
コード内の定数を編集:
```javascript
let spawnInterval = 800;  // ふつうモード（ミリ秒）
if (currentDifficulty === 'hard') spawnInterval = 500;  // むずかしいモード
if (isFever) spawnInterval = 200;  // Fever Time
```

### スコア閾値の変更
```javascript
const CHEEK_THRESHOLDS = [50, 200];  // ほっぺたが膨らむタイミング
```

### アイテム設定
```javascript
const ITEM_TYPES = {
    acorn: { score: 10, speed: 0.005, radius: 0.05 },
    walnut: { score: 30, speed: 0.007, radius: 0.06 },
    chestnut: { score: -50, speed: 0.006, radius: 0.055 }
};
```

## 🐛 既知の問題

- モバイル端末ではパフォーマンスが低下する場合があります（PC推奨）
- 一部のブラウザでは音声の自動再生がブロックされます（ユーザー操作が必要）
- 初回アクセス時にカメラの許可が必要です

画面が狭いですがスマホでも一応遊べます♪

<img src="https://storage.googleapis.com/zenn-user-upload/e85189f060f5-20260106.png" width="300">


## 🤝 コントリビューション

プルリクエストを歓迎します！

1. プロジェクトをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/AmazingFeature`)
3. 変更をコミット (`git commit -m 'Add some AmazingFeature'`)
4. ブランチにプッシュ (`git push origin feature/AmazingFeature`)
5. プルリクエストを開く

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルを参照してください。

## 🙏 クレジット

- **BGM**: "Round Of Incense" by Sound Of Incense ([DOVA-SYNDROME](https://dova-s.jp/))
- **画像素材**: Generated by Gemini
- **手認識技術**: [MediaPipe Hands](https://google.github.io/mediapipe/solutions/hands.html) by Google



